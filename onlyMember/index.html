<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../global.css">
    <link rel="stylesheet" href="./onlyMember.css">
    <title>MGCS-社員ポータル</title>
</head>
<body>
    <header class="toHome">
        <a href="./index.html">
            <img id="MGCS_logo" src="../home/MGCS_logo.svg" height="40px" />
        </a>
        <h1>MGCS社員ポータル</h1>
        <button id="logOutButton" onclick="logOut()">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f"><path d="M206.78-100.78q-44.3 0-75.15-30.85-30.85-30.85-30.85-75.15v-546.44q0-44.3 30.85-75.15 30.85-30.85 75.15-30.85h277.74v106H206.78v546.44h277.74v106H206.78Zm425.87-152.09L559-328.39 657.61-427H355.48v-106h302.13L559-631.61l73.65-75.52L859.22-480 632.65-252.87Z"/></svg>
            <p  style="font-size: .5rem;margin:1px;">log out</p>
        </button>
    </header>
    <div class="spacerM"></div>
    <p id="userName"></p>
    <div class="spacerM"></div>
    <div id="wrapper" style="display: none;">
        <h1>スレッド</h1>
        <button
            id="createThreadsButton"
            onclick="alert('エラーが発生しました。もう一度お試しください。繰り返し起こるようなら佐々木晴政へ伝えてください。')">
            ＋新しく作成
        </button>
        <div id="threadsArea"></div>
        <h1>個人ファイル</h1>
        <div id="stockedFilesArea"></div>
        <button 
            class="fileTips" 
            style="background-color: var(--primary); color:var(--text-light);margin:1em 4px 0.3em 4px; padding:0.6em 1em;font-size: 1.2em;font-weight: 500;width:auto;"
            onclick="alert('エラーが発生しました。もう一度お試しください。繰り返し起こるようなら佐々木晴政へ伝えてください。')">
            ＋アップロード
        </button>
        <button 
            class="" 
            style="background-color: var(--background-light-sub); color:var(--text-dark);margin:0.3em 4px 0.3em 4px; padding:0.6em 1em;width:auto;"
            onclick="alert('エラーが発生しました。もう一度お試しください。繰り返し起こるようなら佐々木晴政へ伝えてください。')">
            送信する>
        </button>
        <h1>個人ファイル</h1>
    </div>
    <div class="spacerM"></div>
    <div class="spacerM"></div>

<script src="./threads.js"></script>
<script src="./thread/file.js"></script>
<script>
if(!localStorage.getItem("userData")){
    location.href = "./admission"
}
//表示
document.getElementById("wrapper").style="block"

const threadsArea = document.getElementById("threadsArea")
const threadsData = JSON.parse(localStorage.getItem("threadsData"))
const userData = JSON.parse(localStorage.getItem("userData"))
threadsData.forEach((x, i) => {
    if(!(x.visibility == "secret" && userData.status == "commons")){
        threadsArea.appendChild(threadsComponent(x, i))
    }
})

function logOut(){
    localStorage.removeItem("userData")
    location.reload()
}

const memberData = JSON.parse(localStorage.getItem("memberData"))
const stockedFilesArea = document.getElementById("stockedFilesArea")
for(let file of memberData[userData.index].stockedFiles){
    stockedFilesArea.appendChild(
        fileComponent(file)
    )
}

document.getElementById("userName").textContent = `[info] user:${userData.name}`
</script>
</body>
</html>